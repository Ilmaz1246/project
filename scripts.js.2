document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('appointment-form');
    const modal = document.querySelector('.modal');
    const closeModalBtn = document.querySelector('.close-modal');
    const closeBtn = document.querySelector('.close-btn');

    function closeModal() {
        modal.style.display = 'none';
    }

    closeModalBtn.addEventListener('click', closeModal);
    closeBtn.addEventListener('click', closeModal);
    
    modal.addEventListener('click', function(e) {
        if (e.target === modal) {
            closeModal();
        }
    });

    if (form) {
        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = {
                name: document.getElementById('name').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                service: document.getElementById('service').value
            };

            if (!formData.name || !formData.phone || !formData.service) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
                return;
            }
            
            try {
                const botToken = '8141168060:AAH1KsbSsoCU8MbavQDPoGo1JPwlYyymydI';
                const chatId = '1071153460';
                
                const message = `üìå –ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞:\n\n
                               üë§ –ò–º—è: ${formData.name}\n
                               üìû –¢–µ–ª–µ—Ñ–æ–Ω: ${formData.phone}\n
                               ü¶∑ –£—Å–ª—É–≥–∞: ${formData.service}`;
                
                const response = await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: chatId,
                        text: message
                    })
                });
                
                if (!response.ok) {
                    throw new Error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram');
                }

                modal.style.display = 'flex';
                
                form.reset();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞:', error);
                alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
            }
        });
    }
});
